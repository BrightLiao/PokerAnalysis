# PokerNow 实时客户端 - 完整说明

## 📋 项目概述

基于 **PokerNow Client** 库开发的实时扑克监控和操作程序，支持：
- ✅ 实时获取游戏状态（底池、公共牌、玩家信息）
- ✅ 命令行交互操作（Call/Raise/Check/Fold）
- ✅ 自动检测行动时机
- ✅ Cookie自动管理

---

## 🚀 快速开始（5分钟）

### 1️⃣ 安装依赖

**自动安装（推荐）：**
```bash
./install.sh
```

**手动安装：**
```bash
# 安装Python包
pip install selenium

# 安装浏览器驱动（macOS）
brew install geckodriver
```

### 2️⃣ 配置游戏URL

编辑 `poker_live_simple.py` 第10行：
```python
GAME_URL = "https://www.pokernow.club/games/你的游戏ID"
```

### 3️⃣ 运行程序

```bash
python poker_live_simple.py
```

### 4️⃣ 首次登录

1. 浏览器自动打开
2. 手动登录PokerNow账号
3. 回到命令行按回车
4. 开始监控！

---

## 📁 项目文件

### 核心程序
| 文件 | 说明 |
|------|------|
| `poker_live_client.py` | 完整版客户端（支持命令行参数） |
| `poker_live_simple.py` | 简化版客户端（快速启动） |

### 文档
| 文件 | 说明 |
|------|------|
| `QUICKSTART.md` | 5分钟快速启动指南 |
| `LIVE_CLIENT_GUIDE.md` | 完整使用文档 |
| `ARCHITECTURE.md` | 系统架构说明 |
| `实时客户端说明.md` | 本文档 |

### 工具
| 文件 | 说明 |
|------|------|
| `install.sh` | 自动安装脚本 |
| `test_environment.py` | 环境测试脚本 |

### 依赖库
```
pokernowclient/PokerNow/  - PokerNow Client库
```

---

## 💻 使用方法

### 方法一：简化版（推荐新手）

```bash
python poker_live_simple.py
```

配置选项在文件开头：
```python
GAME_URL = "游戏URL"
BROWSER = "firefox"  # 或 "chrome"
REFRESH_INTERVAL = 2  # 刷新间隔（秒）
```

### 方法二：命令行版（高级用户）

```bash
# 基本用法
python poker_live_client.py "游戏URL"

# 使用Chrome
python poker_live_client.py "游戏URL" --browser chrome

# 自定义刷新间隔
python poker_live_client.py "游戏URL" --refresh 5

# 跳过登录（已有cookie）
python poker_live_client.py "游戏URL" --no-login
```

---

## 🎮 界面说明

```
======================================================================
  游戏类型: No Limit Holdem    盲注: 50/100
======================================================================

💰 底池: 350
🃏 公共牌: Ace of Spades | King of Hearts | 10 of Diamonds

🎲 庄家位置: 3
👤 当前行动: PlayerName

──────────────────────────────────────────────────────────────────────
玩家信息:
──────────────────────────────────────────────────────────────────────

1. ➡️  你的名字
   筹码: 2500  |  下注: 100
   手牌: Ace of Hearts | King of Spades

2. ✓  对手1
   筹码: 3000  |  下注: 100
   手牌: 🎴🎴

3. ❌ 对手2 (已弃牌)
   筹码: 1500  |  下注: 0
   手牌: 🎴🎴

======================================================================
⏰ 轮到你行动了！
======================================================================

可用行动:
  1. Call
  2. Raise
  3. Fold
  0. 跳过（不行动）

请选择行动 (输入数字): _
```

### 图标说明
- ➡️  当前行动玩家
- ✓  活跃玩家
- ❌ 已弃牌
- 💤 离线

---

## 🔧 常见操作

### 轮到你行动时

**Call/Check/Fold:**
```
请选择行动 (输入数字): 1
执行行动: Call
✓ 行动已执行
```

**Raise:**
```
请选择行动 (输入数字): 2
请输入加注金额: 200
执行行动: Raise 200
✓ 行动已执行
```

**跳过（手动操作）:**
```
请选择行动 (输入数字): 0
等待 2 秒后刷新...
```

### 退出程序

按 `Ctrl+C`

---

## 🐛 故障排查

### 问题1: 浏览器启动失败

**检查驱动：**
```bash
geckodriver --version
chromedriver --version
```

**重新安装：**
```bash
brew reinstall geckodriver
```

### 问题2: Cookie失效

**删除并重新登录：**
```bash
rm poker_cookies.pkl
python poker_live_simple.py
```

### 问题3: 找不到元素

可能原因：
- 页面还未加载完成
- PokerNow网站更新了结构
- 网络延迟

解决方法：
- 增加刷新间隔
- 检查网络连接
- 更新PokerNow Client库

### 问题4: 程序卡住

**强制退出：**
按 `Ctrl+C`

**重启程序：**
```bash
python poker_live_simple.py
```

---

## 🧪 测试环境

运行环境测试：
```bash
python test_environment.py
```

输出示例：
```
======================================================================
PokerNow 实时客户端 - 环境测试
======================================================================

1. 检查Python版本...
   ✓ Python 3.12.7 (符合要求)

2. 检查Selenium...
   ✓ Selenium 4.0.0 已安装

3. 检查WebDriver...
   ✓ geckodriver (Firefox) 可用
   ✓ chromedriver (Chrome) 可用

4. 检查PokerNow Client...
   ✓ PokerNow Client 库可访问

5. 检查项目文件...
   ✓ poker_live_client.py
   ✓ poker_live_simple.py
   ✓ QUICKSTART.md
   ✓ LIVE_CLIENT_GUIDE.md

======================================================================
测试总结
======================================================================

✓ 所有测试通过！环境配置正确。
```

---

## 🏗️ 技术架构

```
命令行界面 (用户输入/显示)
        ↓
PokerLiveClient (监控管理)
        ↓
PokerClient (pokernowclient库)
    ├── GameStateManager (获取游戏状态)
    ├── ActionHelper (执行行动)
    └── CookieManager (登录管理)
        ↓
Selenium WebDriver (浏览器自动化)
        ↓
浏览器 (Firefox/Chrome)
        ↓
PokerNow.club (网站)
```

详细架构请查看：[ARCHITECTURE.md](ARCHITECTURE.md)

---

## 🚀 下一步开发

### 计划中的功能

**1. 集成 Gemini AI 决策**
```python
def get_ai_suggestion(self, state):
    """调用Gemini 2.5 API获取决策建议"""
    # TODO: 实现
    pass
```

**2. 历史记录和统计**
- 集成现有的统计分析模块
- 记录每手牌的详细信息
- 生成对手分析报告

**3. 自动化策略引擎**
- 实现基础策略（紧凶、松凶等）
- 根据位置自动调整
- 底池赔率计算

**4. GUI界面**
- 开发图形界面版本
- 实时图表显示
- 更美观的牌面展示

---

## ⚙️ 高级配置

### 修改刷新间隔

在 `poker_live_simple.py` 中：
```python
REFRESH_INTERVAL = 5  # 改为5秒
```

### 启用无头模式（后台运行）

在 `poker_live_client.py` 的 `_init_driver` 方法中：
```python
options.add_argument('--headless')  # 取消注释
```

### 自定义Cookie路径

```python
client = PokerLiveClient(
    game_url=GAME_URL,
    browser=BROWSER,
    cookie_path='my_cookies.pkl'  # 自定义
)
```

---

## 📚 相关文档

- [快速启动指南](QUICKSTART.md) - 5分钟快速上手
- [完整使用文档](LIVE_CLIENT_GUIDE.md) - 详细功能说明
- [系统架构](ARCHITECTURE.md) - 技术架构详解
- [PokerNow Client README](pokernowclient/README.md) - 底层库文档

---

## ⚠️ 注意事项

1. **遵守规则**: 确保使用符合PokerNow.club服务条款
2. **合理使用**: 避免频繁请求导致账号被封
3. **娱乐为主**: 本工具仅供学习和娱乐使用
4. **安全第一**: 不要在不安全的环境中使用
5. **Cookie安全**: 妥善保管cookie文件

---

## 🎯 功能总结

| 功能 | 状态 | 说明 |
|------|------|------|
| 实时监控游戏状态 | ✅ | 自动刷新显示 |
| 检测行动时机 | ✅ | 轮到你时提示 |
| 命令行操作 | ✅ | Call/Raise/Check/Fold |
| 自动登录 | ✅ | Cookie管理 |
| 多浏览器支持 | ✅ | Firefox/Chrome |
| 环境测试 | ✅ | 一键检测 |
| 自动安装 | ✅ | 安装脚本 |
| AI决策 | 🔄 | 计划中 |
| 历史记录 | 🔄 | 计划中 |
| GUI界面 | 🔄 | 计划中 |

---

## 📞 获取帮助

遇到问题？
1. 查看 [LIVE_CLIENT_GUIDE.md](LIVE_CLIENT_GUIDE.md) 常见问题部分
2. 运行 `python test_environment.py` 检查环境
3. 查看错误日志和提示信息

---

**祝你好运！Good Luck! 🍀🎲**

---

*最后更新: 2025-10-29*

